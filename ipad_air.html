<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <style>
        .btn-primary{
            background-color: white;
            color: blue;
            border: 0;
        }
        .total{
            width: 50%;
            display: flex;
            justify-content: center;
            font-size: x-large;
        }
        .justify-content-between{
            box-shadow: inset 0 -1px #ccc;
            padding: 10px;
        }

    </style>
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col-12 col-md-6">
                <img src="https://store.storeimages.cdn-apple.com/8756/as-images.apple.com/is/ipad-air-finish-select-gallery-202211-space-gray-wifi?wid=2560&hei=1440&fmt=p-jpg&qlt=95&.v=1670948364698" 
                    class = "img-fluid w-100">
            </div>
            <div class="col-12 col-md-6">
                <h2>購買 Ipad Air</h2>
                <!-- Button trigger modal -->
                <div class="color d-flex justify-content-between w-50">
                    <h3>Space_Gray</h3>
                    <button type="button" class="btn btn-primary " data-bs-toggle="modal"
                        data-bs-target="#staticBackdrop-color">
                        更改
                    </button>

                    <!-- Modal -->
                    <div class="modal fade" id="staticBackdrop-color" data-bs-backdrop="static" data-bs-keyboard="false"
                        tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title"><span style="font-weight: 700;">外觀。</span> 挑選喜愛的顏色。</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="list-group color-group">
                                        <button type="button"
                                            class="list-group-item list-group-item-action">Space_Gray</button>
                                        <button type="button" class="list-group-item list-group-item-action">Blue</button>
                                        <button type="button"
                                            class="list-group-item list-group-item-action">Pink</button>
                                        <button type="button" class="list-group-item list-group-item-action">Purple</button>
                                        <button type="button"
                                            class="list-group-item list-group-item-action">Starlight</button>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>


                <div class="GB d-flex justify-content-between w-50">
                    <h3 class="GB-h3">64GB</h3>
                    <button type="button" class="btn btn-primary " data-bs-toggle="modal"
                        data-bs-target="#staticBackdrop-GB">
                        更改
                    </button>

                    <!-- Modal -->
                    <div class="modal fade" id="staticBackdrop-GB" data-bs-backdrop="static" data-bs-keyboard="false"
                        tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title"><span style="font-weight: 700;">儲存裝置。</span> 選擇需要的儲存空間大小。
                                    </h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="list-group">
                                        <button type="button"
                                            class=" list-group-item list-group-item-action GB-group">64 GB</button>
                                        <button type="button"
                                            class=" list-group-item list-group-item-action GB-group">256 GB</button>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <div class="Wi-fi d-flex justify-content-between w-50">
                    <h3>Wi-Fi</h3>
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                        data-bs-target="#staticBackdrop-wifi">
                        更改
                    </button>

                    <!-- Modal -->
                    <div class="modal fade" id="staticBackdrop-wifi" data-bs-backdrop="static" data-bs-keyboard="false"
                        tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="staticBackdropLabel"><span
                                            style="font-weight: 700;">連線能力。</span> 選擇連線方式。</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="list-group ">
                                        <button type="button"
                                            class="list-group-item list-group-item-action Wifi-group">Wi-Fi</button>
                                        <button type="button"
                                            class="list-group-item list-group-item-action Wifi-group">Wi-Fi+行動數據</button>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="total">
                    <p>NT$ <span>19990</span></p>
                </div>





            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>

    <script>


        const xhr = new XMLHttpRequest();
        let data;
        xhr.open('GET', 'https://raw.githubusercontent.com/max910815/JS-iPad-Air-AJAX/main/IpadAir.json');
        xhr.onload = () => {
            if (xhr.status === 200) {
                data = JSON.parse(xhr.responseText);
                console.log(data);
            } else {
                console.log("Error!");
            }
        }
        xhr.send();

        window.onload = function () {
            getGB();
            get_color();
            getWifi();

            
        }

        function getGB() {
            console.log("getGB")
            let GB = document.querySelectorAll(".GB-group")
            let GB_num = 0
            GB.forEach((gb, index) => {
                console.log(gb, index)
                gb.addEventListener("click", function () {
                    let h3 = document.querySelector(".GB-h3")
                    let total = document.querySelector(".total")
                    let total_span = document.querySelector(".total span")
                    // 取得數字
                    let totalAmount = parseInt(total_span.textContent)
                    console.log(GB_num)
                    if (index == 0) {
                        
                        h3.innerHTML = "64GB"
                        if(GB_num == 0){
                            total.innerHTML = `<p>NT$ <span>${totalAmount}</span></p>`;
                        }else{
                            let newTotalAmount = totalAmount - parseInt(data.type.Storage[1]["256GB"]);
                            total.innerHTML = `<p>NT$ <span>${newTotalAmount}</span></p>`;
                            GB_num = 0
                        }
                        
                    } else if (index == 1) {
                        h3.innerHTML = "128GB";
                        if(GB_num == 1){
                            total.innerHTML = `<p>NT$ <span>${totalAmount}</span></p>`;
                        }else{
                            // 將數字加上 5000
                            let newTotalAmount = totalAmount + parseInt(data.type.Storage[1]["256GB"]) ;
                            // 更新 .total 元素的文字內容
                            total.innerHTML = `<p>NT$ <span>${newTotalAmount}</span></p>`;
                            GB_num = 1 
                        }
                        
                    }
                })
            })
        }

        function get_color(){
            let color = document.querySelector(".color-group")
            let color_h3 = document.querySelector(".color h3")
            let img = document.querySelector("img")
            console.log(color)
            data.type.color.forEach(item => {
            color.addEventListener("click", function(){
                let target = event.target;
                    if(Object.keys(item) == target.textContent){
                        let colorObj = Object.values(item)[0]; 
                        Object.keys(colorObj).forEach(key => { 
                            let url = colorObj[key]; 
                            color_h3.innerHTML = `<h3>${Object.keys(item)[0]}</h3>`
                            img.src = url
                            console.log(key,url);
                        });
                    }
                }) 
            })
        }

        function getWifi() {
                let Wifi = document.querySelectorAll(".Wifi-group")
                let wifi_num = 0
                Wifi.forEach((wifi, index) => {
                    console.log(wifi, index)
                    wifi.addEventListener("click", function () {
                        let h3 = document.querySelector(".Wi-fi h3")
                        let total = document.querySelector(".total")
                        let total_span = document.querySelector(".total span")
                        // 取得數字
                        let totalAmount = parseInt(total_span.textContent)
                        console.log(data.type.Connectivity[1]["Wi-Fi+Network"])
                        if (index == 0) {
                            h3.innerHTML = "Wi-Fi+Network"
                            if (wifi_num == 0) {
                                total.innerHTML = `<p>NT$ <span>${totalAmount}</span></p>`;
                            } else {
                                console.log("-5000")
                                let newTotalAmount = totalAmount - parseInt(data.type.Connectivity[1]["Wi-Fi+Network"]);
                                total.innerHTML = `<p>NT$ <span>${newTotalAmount}</span></p>`;
                                wifi_num = 0
                            }

                        } else if (index == 1) {
                            h3.innerHTML = "Wi-Fi+Network";
                            if (wifi_num == 1) {
                                total.innerHTML = `<p>NT$ <span>${totalAmount}</span></p>`;
                            } else {
                                // 將數字加上 5000
                                let newTotalAmount = totalAmount + parseInt(data.type.Connectivity[1]["Wi-Fi+Network"]);
                                // 更新 .total 元素的文字內容
                                total.innerHTML = `<p>NT$ <span>${newTotalAmount}</span></p>`;
                                wifi_num = 1
                            }

                        }
                    })
                })
            }


    </script>
</body>
